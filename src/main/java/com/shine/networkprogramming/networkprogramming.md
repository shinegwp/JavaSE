# 网络编程

## 目的

直接或间接地通过网络协议与其它计算机进行通讯。

## 通信要素
### 1.IP 和 端口号

IP 地址：InetAddress
唯一的标识 Internet 上的计算机
本地回环地址(hostAddress)：127.0.0.1      主机名(hostName)：localhost

端口号标识正在计算机上运行的进程（程序）
不同的进程有不同的端口号
被规定为一个 16 位的整数 0~65535。其中，0~1023被预先定义的服务通信占用（如MySql占用端口3306，http占用端口80等）。除非我们需要访问这些特定服务，否则，就应该使用 1024~65535 这些端口中的某一个进行通信，以免发生端口冲突。 

端口号与IP地址的组合得出一个网络套接字。


链接过程：先找本机hosts，是否有输入的域名地址，没有的话，再通过DNS服务器，找主机。

### 2.网络通信协议

#### TCP协议：
使用TCP协议前，须先建立TCP连接，形成传输数据通道

传输前，采用“三次握手”方式，是可靠的（这个过程可以简单描述为主机A向主机B发出请求建立连接的数据包，这是第一次会话，第二次会话为主机B向主机A发送同意建立及一些其他信息的数据包，第三次会话为主机A向主机B发送表示确认的数据包）

TCP协议进行通信的两个应用进程：客户端、服务端

在连接中可进行大数据量的传输

传输完毕，需释放已建立的连接，效率低

#### UDP协议：
将数据、源、目的封装成数据包，不需要建立连接

每个数据报的大小限制在64K内

因无需连接，故是不可靠的

发送数据结束时无需释放资源，速度快

#### Socket
通信的两端都要有Socket，是两台机器间通信的端点

网络通信其实就是Socket间的通信。

Socket允许程序把网络连接当成一个流，数据在两个Socket间通过IO传输。

一般主动发起通信的应用程序属客户端，等待通信请求的         
  为服务端


## 通信协议

### OSI参考模型

应用层，表示层，会话层，传输层，网络层，数据链路层，物理层

### TCP/IP参考模型

#### 应用层
HTTP（超文本传输协议）

DNS（域名系统）

FTP（文件传送协议）

Telnet（远程登陆协议）

SMTP（简单邮件传输协议）

#### 传输层
##### TCP协议
使用TCP协议前，须先建立TCP连接，形成传输数据通道

传输前，采用“三次握手”方式，是可靠的（这个过程可以简单描述为主机A向主机B发出请求建立连接的数据包，这是第一次会话，第二次会话为主机B向主机A发送同意建立及一些其他信息的数据包，第三次会话为主机A向主机B发送表示确认的数据包）

TCP协议进行通信的两个应用进程：客户端、服务端

在连接中可进行大数据量的传输

传输完毕，需释放已建立的连接，效率低

##### UDP协议
将数据、源、目的封装成数据包，不需要建立连接

每个数据报的大小限制在64K内

因无需连接，故是不可靠的

发送数据结束时无需释放资源，速度快
##### 两者区别
1.TCP协议面向连接，是流传输协议，通过连接发送数据，而UDP协议传输不需要连接，是数据报协议。；

2.TCP为可靠传输协议，而UDP为不可靠协议。即TCP协议可以保证数据的完整和有序，而UDP不能保证；

3.UDP由于不需要连接，故传输速度比TCP快，且占用资源比TCP少。

4.应用场合：TCP协议常用在对数据文件完整性较高的一些场景中，如文件传输等。UDP常用于对通讯速度有较高要求以及数据较少时，如要求速度的直播，传输数据较少的QQ等。
#### 网络层

1.IP：负责网络层寻址、路由选择、分段及包重组；

2.ARP：负责把IP地址解析成物理地址。在实际进行通信时， 物理网络所使用的是物理地址，IP地址是不能被物理网络识别的。对于以太网而言，当IP数据包通过以太网发送时，以太网设备是以MAC地址传输数据的，ARP协议就是用来将IP地址解析成MAC地址的；

3.RARP：负责把物理地址解析成IP地址，常用于无盘工作站通过其MAC地址从服务器处解析对应的IP地址；

4.ICMP：定义了网络层控制和传递消息的功能，可以报告IP数据包传送过程中发生的错误、失败等信息，提供网络诊断功能。ping和tracert两个使用极其广泛的测试工具就是ICMP消息的应用；

5.IGMP：负责管理IP组播组。用于支持在主机和路由器之间进行组播传输数据，它让一个物理网络上的所有路由器知道当前网络中有哪些主机需要组播。组播路由器需要这些信息以便知道组播数据包应该像哪些接口转发。

#### 物理数据链路层